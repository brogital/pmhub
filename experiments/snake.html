<!doctype html>
<html lang="ru">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Змейка — PM Hub</title>
	<link rel="icon" href="../assets/favicon.svg" type="image/svg+xml">
	<link rel="stylesheet" href="../assets/css/styles.css">
	<style>
		body { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; margin: 0; background-color: #f0f0f0; }
		canvas { background-color: #333; border: 2px solid #555; }
		.game-container { text-align: center; margin-bottom: 20px; }
		.score { font-size: 1.5em; margin-bottom: 10px; }
		.controls { margin-top: 20px; }
		.controls button { padding: 10px 20px; font-size: 1em; margin: 0 10px; cursor: pointer; }
	</style>
</head>
<body>
	<header class="site-header">
		<div class="container header-inner">
			<a class="logo" href="../index.html">PM Hub</a>
			<nav class="nav" id="site-nav">
				<a href="../articles/index.html">Статьи</a>
				<a href="../services/index.html">Услуги</a>
				<a href="./index.html" aria-current="page">Шатаем ИИ</a>
			</nav>
			<button class="nav-toggle" aria-controls="site-nav" aria-expanded="false">Меню</button>
		</div>
	</header>
	<main>
		<section class="section">
			<div class="container stack-lg">
				<h1>Игра Змейка</h1>
				<div class="game-container">
					<div class="score">Счет: <span id="score">0</span></div>
					<canvas id="gameCanvas" width="400" height="400"></canvas>
					<div class="controls">
						<button id="startButton">Начать игру</button>
					</div>
				</div>
			</div>
		</section>
	</main>
	<footer class="site-footer">
		<div class="container section-sm">
			<p>© <span id="year"></span> PM Hub</p>
		</div>
	</footer>
	<script src="../assets/js/main.js"></script>
	<script>
		const canvas = document.getElementById('gameCanvas');
		const ctx = canvas.getContext('2d');
		const scoreDisplay = document.getElementById('score');
		const startButton = document.getElementById('startButton');

		const gridSize = 20;
		let snake = [{ x: 10, y: 10 }];
		let food = {};
		let direction = 'right';
		let score = 0;
		let gameInterval;
		let gameSpeed = 150;

		function generateFood() {
			food = {
				x: Math.floor(Math.random() * (canvas.width / gridSize)),
				y: Math.floor(Math.random() * (canvas.height / gridSize))
			};
		}

		function draw() {
			ctx.clearRect(0, 0, canvas.width, canvas.height);

			for (let i = 0; i < snake.length; i++) {
				ctx.fillStyle = i === 0 ? 'green' : 'lightgreen';
				ctx.fillRect(snake[i].x * gridSize, snake[i].y * gridSize, gridSize, gridSize);
			}

			ctx.fillStyle = 'red';
			ctx.fillRect(food.x * gridSize, food.y * gridSize, gridSize, gridSize);
		}

		function update() {
			const head = { x: snake[0].x, y: snake[0].y };

			switch (direction) {
				case 'up': head.y--; break;
				case 'down': head.y++; break;
				case 'left': head.x--; break;
				case 'right': head.x++; break;
			}

			if (head.x < 0 || head.x >= canvas.width / gridSize ||
				head.y < 0 || head.y >= canvas.height / gridSize ||
				checkCollision(head))
			{
				clearInterval(gameInterval);
				alert('Игра окончена! Ваш счет: ' + score);
				resetGame();
				return;
			}

			snake.unshift(head);

			if (head.x === food.x && head.y === food.y) {
				score++;
				scoreDisplay.textContent = score;
				generateFood();
			} else {
				snake.pop();
			}

			draw();
		}

		function checkCollision(head) {
			for (let i = 1; i < snake.length; i++) {
				if (head.x === snake[i].x && head.y === snake[i].y) {
					return true;
				}
			}
			return false;
		}

		function changeDirection(event) {
			const keyPressed = event.keyCode;
			const LEFT = 37;
			const UP = 38;
			const RIGHT = 39;
			const DOWN = 40;

			if (keyPressed === LEFT && direction !== 'right') { direction = 'left'; }
			if (keyPressed === UP && direction !== 'down') { direction = 'up'; }
				if (keyPressed === RIGHT && direction !== 'left') { direction = 'right'; }
				if (keyPressed === DOWN && direction !== 'up') { direction = 'down'; }
		}

		function startGame() {
			resetGame();
			generateFood();
			document.addEventListener('keydown', changeDirection);
			gameInterval = setInterval(update, gameSpeed);
			startButton.textContent = 'Перезапустить игру';
		}

		function resetGame() {
			clearInterval(gameInterval);
			snake = [{ x: 10, y: 10 }];
			direction = 'right';
			score = 0;
			scoreDisplay.textContent = score;
			draw();
		}

		startButton.addEventListener('click', startGame);

		// Initial draw
		draw();
	</script>
</body>
</html>

